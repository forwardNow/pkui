define(function(a){"use strict";function b(){var a=f("[data-"+j.componentMarkupProp+"]").not("[isrendered]");a.each(function(){var a,b=f(this),c=b.data(j.componentMarkupProp),d=b.data(j.optionsMarkupProp)||{};""!==f.trim(c)&&(a=c.indexOf("|")!==-1?c.split("|"):[c],f.isArray(d)||(d=[d]),f.each(a,function(a,c){var e=d[a]||{},g=j.component[f.trim(c)],h=c;if(g)g.call(b,e);else{switch(c){case"datagrid":h="bootgrid";break;case"drawer":h="drawer";break;case"form":h="form";break;case"validator":h="validator"}seajs.use([h],function(){j.component[f.trim(c)].call(b,e)})}}))})}function c(a){return 0===arguments.length?void console.info("/(ㄒoㄒ)/~~ 请设置参数。"):(j.isAutoRender=Boolean(a),void(a?c.pointcutHandlerList=[g.after(f.prototype,"html",b)]:f.each(c.pointcutHandlerList,function(a,b){b.remove()})))}function d(){g.before(f,"ajax",function(a,b){"object"==typeof a&&(b=a,a=void 0),b.url.indexOf("__CTX__")!==-1&&(b.url=b.url.replace("__CTX__",j.ctxPath))})}function e(){var a=".pkui.global";i.on("click"+a,".pkui-click-hide",function(){f(this).hide()})}a("isLoading"),a("css/font/font-awesome/4.7.0/font-awesome.css"),a("layer"),a("lib/layer/3.0.1.x/skin/default/layer.css");var f=a("jquery"),g=a("meld"),h=window["www.pkusoft.net"],i=f(window.document),j={componentMarkupProp:"pkui-component",optionsMarkupProp:"pkui-component-options",ctxPath:h.ctxPath,basePath:h.pkuiBasePath,dicPath:h.ctxPath+"/static/dic/",timestamp:h.timestamp,component:{},load:seajs.use,render:b,isAutoRender:!0,setAutoRender:c};location.href.indexOf("localhost")!==-1&&h.pkuiBasePath.indexOf("static")===-1&&(j.ctxPath="http://localhost:8080/pkui",j.dicPath="http://localhost:8080/pkui/static/dic/"),j._init=function(){f(document).ready(b),d(),e(),this.setAutoRender(this.isAutoRender),window.PKUI=j},f.extend(j,{handleJsonResult:function(a){return"string"==typeof a&&(a=f.parseJSON(a)),a},handleGridResult:function(a){return j.handleJsonResult(a)},getTreeList:function(a){function b(a){var c=[];return a&&a.length?(f.each(a,function(a,d){var e,g=d;e=f.extend({},g),e[k]=b(l[g[i]]),c.push(e)}),c):null}var c,d,e,g=a.data,h=a.rootId,i=a.idName||"id",j=a.parentIdName||"parentId",k=a.childrenName||"children",l={};return h||(h=g[0][i]),f.each(g,function(a,b){d=b[j],l[d]=l[d]||[],l[d].push(b)}),e=g[h],f.isArray(e)||(e=[e]),c=b(e)}}),j._init()});