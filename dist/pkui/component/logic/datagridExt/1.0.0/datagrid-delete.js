define(function(a){function b(a,b){this.options=f.extend(!0,{},e,b),this.$target=f(a),this.$datagrid=f(this.options.datagridSelector),c.call(this)}function c(){var a=this.options,b=this.$target,c=this.$datagrid;this.$target.on("click."+h,function(){d(c,b,a)})}function d(a,b,c){function d(){b.isLoading({position:"insideButton"}),f.each(e,function(a,b){a>0&&(h+="&"),h+=c.PKName+"="+b}),f.ajax({url:c.url,data:h}).done(function(b){b.success?(g.msg(b.message||"删除成功！",{icon:1}),a.bootgrid("deleteRow",e)):g.alert("删除失败："+(b.message||"未知的错误"),{icon:2})}).fail(function(){g.alert("网络错误/登陆失效！",{icon:0})}).always(function(){b.isLoading("hide")})}var e=a.bootgrid("getSelectedRows"),h="";if(!b.attr("disabled"))return 0===e.length?void g.msg("请选中一条或多条记录进行删除！",{icon:0}):void g.confirm("是否删除？",{btn:["删除","取消"]},function(a){d(),g.close(a)},function(){})}var e,f=(a("bootgrid"),a("jquery")),g=window.layer,h="pkui.datagrid.delete";e={datagridSelector:"",PKName:"",url:""},f.fn.DatagridDelete=function(a){var c=this,d=arguments;return c.each(function(){var c=f(this).data(h);if(c){if("string"==typeof a){if("_"===a.charAt(0))return;c[a].apply(c,[].slice.call(d,1))}}else f(this).data(h,new b(this,a)),f(this).attr("isrendered",!0)}),this},window.PKUI.component["datagrid-delete"]=f.fn.DatagridDelete});